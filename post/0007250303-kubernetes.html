<!DOCTYPE html><html lang="ko" class="__className_c5102c"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/tech-blog/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/tech-blog/_next/static/css/2902b82ade31b364.css" data-precedence="next"/><link rel="stylesheet" href="/tech-blog/_next/static/css/86708423b213bf15.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/tech-blog/_next/static/chunks/webpack-55be747906e2abed.js"/><script src="/tech-blog/_next/static/chunks/fd9d1056-12d0224c61359539.js" async=""></script><script src="/tech-blog/_next/static/chunks/117-d2d2b15d916da2d9.js" async=""></script><script src="/tech-blog/_next/static/chunks/main-app-dc241a590481c956.js" async=""></script><script src="/tech-blog/_next/static/chunks/679-09931d2c20ac23c4.js" async=""></script><script src="/tech-blog/_next/static/chunks/app/layout-04b5cc4ae96ec103.js" async=""></script><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6151583773425822" crossorigin="anonymous"></script><script src="/tech-blog/_next/static/chunks/app/post/%5Bslug%5D/page-5fc1a46522590ee2.js" async=""></script><meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)"/><meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)"/><meta name="naver-site-verification" content="1df124e1d8331da4467178ffddd6188e1d413576"/><meta name="google-adsense-account" content="ca-pub-6151583773425822"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="dns-prefetch" href="https://fonts.gstatic.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><title>Volume (emptyDir, hostPath, PVC/PV) | Nimkoes Tech Blog</title><meta name="description" content="기본 설명"/><meta name="application-name" content="Nimkoes Tech Blog"/><link rel="author" href="https://nimkoes.github.io/tech-blog"/><meta name="author" content="Nimkoes"/><link rel="manifest" href="/tech-blog/site.webmanifest" crossorigin="use-credentials"/><meta name="keywords" content="tech-blog,backend,software architect,infrastructure,development"/><meta name="creator" content="Nimkoes"/><meta name="publisher" content="Nimkoes"/><meta name="robots" content="index, follow, nocache"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><meta name="category" content="technology"/><link rel="canonical" href="https://nimkoes.github.io/tech-blog"/><link rel="alternate" hrefLang="ko-KR" href="https://nimkoes.github.io/tech-blog"/><meta name="format-detection" content="telephone=no, address=no, email=no"/><meta name="google-adsense-account" content="ca-pub-6151583773425822"/><meta property="og:title" content="Nimkoes Tech Blog - 개발자의 기술 이야기"/><meta property="og:description" content="I work diligently to become lazy ☕"/><meta property="og:url" content="https://nimkoes.github.io/tech-blog"/><meta property="og:site_name" content="Nimkoes Tech Blog"/><meta property="og:locale" content="ko_KR"/><meta property="og:image" content="https://nimkoes.github.io/tech-blog/og-image.png"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:alt" content="Nimkoes Tech Blog"/><meta property="og:image:type" content="image/png"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@nimkoes"/><meta name="twitter:creator" content="@nimkoes"/><meta name="twitter:title" content="Nimkoes Tech Blog"/><meta name="twitter:description" content="I work diligently to become lazy ☕"/><meta name="twitter:image" content="https://nimkoes.github.io/tech-blog/og-image.png"/><link rel="icon" href="/tech-blog/favicon.ico" sizes="any"/><link rel="icon" href="/tech-blog/icon.svg" type="image/svg+xml"/><link rel="icon" href="/tech-blog/favicon-32x32.png" sizes="32x32" type="image/png"/><link rel="icon" href="/tech-blog/favicon-16x16.png" sizes="16x16" type="image/png"/><link rel="apple-touch-icon" href="/tech-blog/apple-touch-icon.png" sizes="180x180" type="image/png"/><link rel="mask-icon" href="/tech-blog/safari-pinned-tab.svg" color="#5bbad5"/><meta name="next-size-adjust"/><script src="/tech-blog/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="layout_home__0Lbpw"><aside class="NavigationView_navigationView__9z_1q"><div class="NavigationView_navigation__E0_xU"><button class="Button_button__aem_D Button_icon__S9jrr Button_medium__xLUiz NavigationView_navButton__QKsJg " aria-label="카테고리 보기"></button><button class="Button_button__aem_D Button_icon__S9jrr Button_medium__xLUiz NavigationView_navButton__QKsJg " aria-label="로그 보기"></button></div></aside><div class="layout_page__rCnOA" style="height:100vh"><div class="layout_subPage__irpRs"><div class="layout_contentsView__k4Q_k contentsView"><div><header class="PostHeader_postHeader__OohTH"><h1 class="PostHeader_title__NoKGt">Volume (emptyDir, hostPath, PVC/PV)</h1><p class="PostHeader_description__moC_r"></p><div class="PostHeader_meta__9Swgx"><span>nimkoes</span><span>2021-03-02</span></div><div class="PostHeader_tags__lGQ1Q"><span class="PostHeader_tag__Jf7BC">Kubernetes</span><span class="PostHeader_tag__Jf7BC">k8s</span><span class="PostHeader_tag__Jf7BC">infra</span></div></header><div class="TableOfContents_tocWrapper__wUNrb "><div class="TableOfContents_tocBox__GAFU7"><div class="TableOfContents_tocHeader__EikQq"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="4" width="20" height="16" rx="3" stroke="#CCCCCC" stroke-width="1.5"></rect><circle cx="6" cy="8" r="1.5" fill="#CCCCCC"></circle><circle cx="6" cy="12" r="1.5" fill="#CCCCCC"></circle><circle cx="6" cy="16" r="1.5" fill="#CCCCCC"></circle><line x1="9" y1="8" x2="18" y2="8" stroke="#CCCCCC" stroke-width="1.5"></line><line x1="9" y1="12" x2="18" y2="12" stroke="#CCCCCC" stroke-width="1.5"></line><line x1="9" y1="16" x2="18" y2="16" stroke="#CCCCCC" stroke-width="1.5"></line></svg><span class="TableOfContents_tocText__Mmsk2">Table of Contents</span></div><ul></ul></div></div><article class="page_markdown__SVl4d"><div class="KakaoAdFit_adContainer__TWxMq page_topAd__ctbB7"></div><div></div><div class="GoogleAdsense_adContainer__8AKIp page_middleAd__4qBOv"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6151583773425822" data-ad-slot="your-ad-slot-id" data-ad-format="auto" data-full-width-responsive="true"></ins></div><div><p><img src="/tech-blog/resources/images/kubernetes/0007-01.png" alt="0007-01"></p>
<h1>emptyDir</h1>
<p>Container 간 데이터 공유를 위해 Volume 을 사용하는 것을 말한다. 최초 Volume 이 생성될 때는 항상 내용이 비어있기 때문에 emptyDir 이란 이름을 가지게 되었다.</p>
<p><img src="/tech-blog/resources/images/kubernetes/0007-02.png" alt="0007-02"></p>
<p>만약 Container 1 이 web 역할을 하는 서버이고 Container 2 는 백엔드를 처리해주는 서버라고 하자. 이 때 web 서버로부터 받은 파일을 mount 된 Volume 에 저장해두고 백엔드의
Container 역시 같은 Volume 을 mount 해두면 이 두 서버가 Volume 을 자신의 로컬에 있는 파일 처럼 사용할 수 있다. 즉 두 서버 간 파일 전송 없이 같은 파일을 사용할 수 있다.</p>
<p>추가로 Volume 은 Pod 안에 생성되기 때문에 만약 Pod 에 문제가 발생하여 다시 생성 될 경우 모든 데이터가 삭제된다. 그러므로 일시적으로 사용 할 데이터만 넣는 것이 좋다.</p>
<pre><code class="hljs language-yml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">pod-volume-1</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">containers:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">container1</span>
      <span class="hljs-attr">image:</span> <span class="hljs-string">kubetm/init</span>
      <span class="hljs-attr">volumeMounts:</span> <span class="hljs-comment"># Volume mount</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">empty-dir</span>
          <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/mount1</span>  <span class="hljs-comment"># Container1 이 사용하는 path => /mount1</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">container2</span>
      <span class="hljs-attr">image:</span> <span class="hljs-string">kubetm/init</span>
      <span class="hljs-attr">volumeMounts:</span> <span class="hljs-comment"># Volume mount</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">empty-dir</span>
          <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/mount2</span>  <span class="hljs-comment"># Container2 가 사용하는 path => /mount2</span>
  <span class="hljs-attr">volumes:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">empty-dir</span>
      <span class="hljs-attr">emptyDir:</span> { }          <span class="hljs-comment"># Volume 의 속성으로 emptyDir 을 지정</span>

<span class="hljs-comment"># mountPath : Container 가 이 Path 로 Volume 을 연결함을 의미</span>
<span class="hljs-comment"># mountPath 의 경로가 다르지만 Path 가 지정되는 Volume 의 이름이</span>
<span class="hljs-comment">#  empty-dir 로 동일하기 때문에 container 마다 자신이 원하는 경로를 사용하고 있지만</span>
<span class="hljs-comment">#  결국 같은 Volume 을 mount 하고 있다.</span>
</code></pre>
<h1>hostPath</h1>
<p>이름에서 알 수 있듯 하나의 host 즉, Pod 들이 올라가 있는 Node 에 path 를 Volume 으로 사용한다.</p>
<p><img src="/tech-blog/resources/images/kubernetes/0007-03.png" alt="0007-03"></p>
<p>emptyDir 과 다른 점은 Path 를 각 Pod 들이 mount 해서 공유하기 때문에 Pod 가 삭제 되어도 Node 에 있는 데이터는 사라지지 않는다. 데이터가 사라지지 않아 좋아 보이지만 Pod 입장에서
문제가 있다.</p>
<p><img src="/tech-blog/resources/images/kubernetes/0007-04.png" alt="0007-04"></p>
<p>만약 다양한 이유로 Pod 가 다시 생성될 때 다른 Node 에 만들어지는 경우 Pod 가 사용하던 Volume 은 hostPath 에 mount 되어있었기 때문에 Volume 을 사용할 수 없게 된다. 왜냐하면
Pod 는 자신이 올라간 Node 에 있는 Volume 만 사용할 수 있기 때문이다.</p>
<p>Pod 가 다시 생성되는 경우 발생하는 문제를 해결한다고 하면, Node 가 생성될 때마다 같은 이름의 경로를 만들어서 직접 Node 에 있는 Path 끼리 mount 해주면 되긴 하지만 이 방법은 k8s 가 해주지
않고 관리자가 직접 설정해줘야 한다. 이렇게 구성하는 것이 그렇게 어렵고 복잡한 것은 아니지만 실수할 여지가 있기 때문에 추천하는 방법은 아니다.</p>
<p>각 Node 는 기본적으로 시스템 파일 또는 다양한 설정 파일과 같이 자기 자신을 위해 사용되는 파일들이 있다. Pod 자신이 할당되어 있는 host 에 데이터를 읽거나 써야할 때 사용하면 된다.</p>
<pre><code class="hljs language-yml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">pod-volume-3</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">nodeSelector:</span>
    <span class="hljs-attr">kubernetes.io/hostname:</span> <span class="hljs-string">k8s-node1</span>
  <span class="hljs-attr">containers:</span> <span class="hljs-comment"># Pod 를 만들 때 Conatiner 에서 </span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">container</span>
      <span class="hljs-attr">image:</span> <span class="hljs-string">kubetm/init</span>
      <span class="hljs-attr">volumeMounts:</span> <span class="hljs-comment"># Volume 을 mount 하는데</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">host-path</span>         <span class="hljs-comment"># host-path 라는 이름의 Volume 을 사용 하고</span>
          <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/mount1</span>      <span class="hljs-comment"># Path 는 mount1 이다.</span>
  <span class="hljs-attr">volumes:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">host-path</span>          <span class="hljs-comment"># host-path 라는 이름의 Volume</span>
      <span class="hljs-attr">hostPath:</span> <span class="hljs-comment"># hostPath 라는 속성을 사용한다.</span>
        <span class="hljs-attr">path:</span> <span class="hljs-string">/node-v</span>           <span class="hljs-comment"># Path 는 node-v 이고 </span>
        <span class="hljs-attr">type:</span> <span class="hljs-string">Directory</span>         <span class="hljs-comment"># type 은 Directory 이다.</span>

<span class="hljs-comment"># 추가로 hostPaht 의 path: /node-v 는 이 Pod 가 만들어지기 전에 만들어져 있어야 한다.</span>
</code></pre>
<p>hostPath 는 Pod 의 데이터를 저장하기 위한 용도가 아니고 Node 에 있는 데이터를 Pod 에서 사용하기 위한 용도이다.</p>
<h1>PVC/PV (Persistent Volume Claim/ Persistent Volume)</h1>
<p>PVC/PV 는 Pod 에 영속성 있는 Volume 을 제공하기 위한 기능이다.</p>
<p><img src="/tech-blog/resources/images/kubernetes/0007-05.png" alt="0007-05"></p>
<p>실제 Volume 의 형태는 다양하다. Local Volume 도 있지만 외부에 원격으로 사용되는 형태의 aws, git 등과 같은 Volume 들도 있다.</p>
<p>Pod 는 이런 PV 에 바로 연결하지 않고 PVC 를 통해 PV 와 연결 된다. k8s 는 Volume 사용에 있어서 User 영역과 Admin 영역으로 나누었다. Admin 은 k8s 를 관리하는 운영자이고
User 는 Pod 에 Service 를 만들고 배포를 관리하는 서비스 담당자 이다.</p>
<p>앞서 Volume 의 종류가 다양하기 때문에 각 Volume 에 연결하기 위한 방법과 설정이 상이하다.</p>
<pre><code class="hljs language-yml"><span class="hljs-comment"># 각 Volume 에 따라 서로 다른 설정 값이 사용 되는 예시 (nfs, iscsi, gitrepo)</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">PersistentVolume</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">pv-01</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">nfs:</span>
    <span class="hljs-attr">server:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-string">.xxx</span>
    <span class="hljs-attr">path:</span> <span class="hljs-string">/sda/data</span>
  <span class="hljs-attr">iscsi:</span>
    <span class="hljs-attr">targetPortal:</span> <span class="hljs-number">163.180</span><span class="hljs-number">.11</span>
    <span class="hljs-attr">iqn:</span> <span class="hljs-string">iqn.200.qnap:...</span>
    <span class="hljs-attr">lun:</span> <span class="hljs-number">0</span>
    <span class="hljs-attr">fsType:</span> <span class="hljs-string">ext4</span>
    <span class="hljs-attr">readOnly:</span> <span class="hljs-literal">no</span>
    <span class="hljs-attr">chapAuthSession:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">gitRepo:</span>
    <span class="hljs-attr">repository:</span> <span class="hljs-string">github.com...</span>
    <span class="hljs-attr">revision:</span> <span class="hljs-string">master</span>
    <span class="hljs-attr">directory:</span> <span class="hljs-string">.</span>
</code></pre>
<p>그렇기 때문에 이런 설정들을 전문적으로 관리하는 PV 들을 만들어 사용하고 User 는 이것을 사용 하기 위해 PVC 를 만들게 된다.</p>
<pre><code class="hljs language-yml"><span class="hljs-comment"># PV 를 사용하기 위한 User 의 PVC 설정 예시</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">PersistentVolumeClaim</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">pvc-01</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">accessModes:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">ReadWriteOnce</span>          <span class="hljs-comment"># 읽기 쓰기 모드가 가능한</span>
  <span class="hljs-attr">resources:</span>
    <span class="hljs-attr">requests:</span>
      <span class="hljs-attr">storage:</span> <span class="hljs-string">1G</span>          <span class="hljs-comment"># 용량 1 기가인 Volume 을 요청</span>
  <span class="hljs-attr">storageClassName:</span> <span class="hljs-string">""</span>     <span class="hljs-comment"># 공백으로 넣으면 현재 만들어진 PV 중 선택 된다</span>
  <span class="hljs-comment"># 이 값을 "" 대신 생략하게 되면 다른 동작을 할 수 있다.</span>
</code></pre>
<pre><code class="hljs language-yml"><span class="hljs-comment"># PVC 를 사용하는 Pod 설정 예시</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">pod-volume-3</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">containers:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">container</span>
      <span class="hljs-attr">image:</span> <span class="hljs-string">kubetm/init</span>
      <span class="hljs-attr">volumeMounts:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">pvc-pv</span>         <span class="hljs-comment"># 만든어진 PVC 를 Container 에서 사용</span>
          <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/mount3</span>
  <span class="hljs-attr">volumes:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">pvc-pv</span>
      <span class="hljs-attr">persistentVolumeClaim:</span>
        <span class="hljs-attr">claimName:</span> <span class="hljs-string">pvc-01</span>     <span class="hljs-comment"># 앞서 만든 PVC 이름을 연결</span>
</code></pre>
<p>처리 흐름을 정리하면 다음과 같다.</p>
<ol>
<li>최초 Admin 이 PV 를 만들어 둔다.</li>
<li>사용자 (User) 가 PVC 를 만든다.</li>
<li>k8s 가 PVC 내용에 맞는 적정한 Volume 에 연결 해준다.</li>
<li>이후 Pod 생성시 PVC 를 사용한다.</li>
</ol></div><div class="GoogleAdsense_adContainer__8AKIp page_bottomAd__f0OO_"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6151583773425822" data-ad-slot="your-ad-slot-id" data-ad-format="auto" data-full-width-responsive="true"></ins></div></article></div><div class="page_floatingButtons__qJiZU"><button class="GoToHome_goToHome__Es1L5"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 2L2 7V14H6V9H10V14H14V7L8 2Z" fill="currentColor"></path></svg></button></div><button class="ScrollToTop_scrollToTop__7NKxR " aria-label="Scroll to top" type="button"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3L3 8M8 3L13 8M8 3V13"></path></svg></button></div></div></div><script src="/tech-blog/_next/static/chunks/webpack-55be747906e2abed.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/tech-blog/_next/static/media/a34f9d1faa5f3315-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/tech-blog/_next/static/css/2902b82ade31b364.css\",\"style\"]\n3:HL[\"/tech-blog/_next/static/css/86708423b213bf15.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[2846,[],\"\"]\n7:I[4707,[],\"\"]\n9:I[6423,[],\"\"]\na:I[4829,[\"679\",\"static/chunks/679-09931d2c20ac23c4.js\",\"185\",\"static/chunks/app/layout-04b5cc4ae96ec103.js\"],\"default\"]\nc:I[1060,[],\"\"]\n8:[\"slug\",\"0007250303-kubernetes\",\"d\"]\nd:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L4\",null,{\"buildId\":\"SUaIxkIYtXmGbhpzbpMvV\",\"assetPrefix\":\"/tech-blog\",\"urlParts\":[\"\",\"post\",\"0007250303-kubernetes\"],\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"slug\",\"0007250303-kubernetes\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"0007250303-kubernetes\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"post\",{\"children\":[[\"slug\",\"0007250303-kubernetes\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",\"$L6\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/tech-blog/_next/static/css/86708423b213bf15.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$8\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/tech-blog/_next/static/css/2902b82ade31b364.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko\",\"className\":\"__className_c5102c\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#ffffff\",\"media\":\"(prefers-color-scheme: light)\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#000000\",\"media\":\"(prefers-color-scheme: dark)\"}],[\"$\",\"meta\",null,{\"name\":\"naver-site-verification\",\"content\":\"1df124e1d8331da4467178ffddd6188e1d413576\"}],[\"$\",\"meta\",null,{\"name\":\"google-adsense-account\",\"content\":\"ca-pub-6151583773425822\"}],[\"$\",\"link\",null,{\"rel\":\"dns-prefetch\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"dns-prefetch\",\"href\":\"https://fonts.gstatic.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"script\",null,{\"async\":true,\"src\":\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6151583773425822\",\"crossOrigin\":\"anonymous\"}]]}],[\"$\",\"$La\",null,{\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}]]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lb\"],\"globalErrorComponent\":\"$c\",\"missingSlots\":\"$Wd\"}]\n"])</script><script>self.__next_f.push([1,"e:I[2089,[\"605\",\"static/chunks/app/post/%5Bslug%5D/page-5fc1a46522590ee2.js\"],\"default\"]\nf:I[3299,[\"605\",\"static/chunks/app/post/%5Bslug%5D/page-5fc1a46522590ee2.js\"],\"default\"]\n10:I[1040,[\"605\",\"static/chunks/app/post/%5Bslug%5D/page-5fc1a46522590ee2.js\"],\"default\"]\n12:I[2786,[\"605\",\"static/chunks/app/post/%5Bslug%5D/page-5fc1a46522590ee2.js\"],\"default\"]\n13:I[6798,[\"605\",\"static/chunks/app/post/%5Bslug%5D/page-5fc1a46522590ee2.js\"],\"default\"]\n11:T32d9,"])</script><script>self.__next_f.push([1,"\u003cp\u003e\u003cimg src=\"/tech-blog/resources/images/kubernetes/0007-01.png\" alt=\"0007-01\"\u003e\u003c/p\u003e\n\u003ch1\u003eemptyDir\u003c/h1\u003e\n\u003cp\u003eContainer 간 데이터 공유를 위해 Volume 을 사용하는 것을 말한다. 최초 Volume 이 생성될 때는 항상 내용이 비어있기 때문에 emptyDir 이란 이름을 가지게 되었다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/tech-blog/resources/images/kubernetes/0007-02.png\" alt=\"0007-02\"\u003e\u003c/p\u003e\n\u003cp\u003e만약 Container 1 이 web 역할을 하는 서버이고 Container 2 는 백엔드를 처리해주는 서버라고 하자. 이 때 web 서버로부터 받은 파일을 mount 된 Volume 에 저장해두고 백엔드의\nContainer 역시 같은 Volume 을 mount 해두면 이 두 서버가 Volume 을 자신의 로컬에 있는 파일 처럼 사용할 수 있다. 즉 두 서버 간 파일 전송 없이 같은 파일을 사용할 수 있다.\u003c/p\u003e\n\u003cp\u003e추가로 Volume 은 Pod 안에 생성되기 때문에 만약 Pod 에 문제가 발생하여 다시 생성 될 경우 모든 데이터가 삭제된다. 그러므로 일시적으로 사용 할 데이터만 넣는 것이 좋다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yml\"\u003e\u003cspan class=\"hljs-attr\"\u003eapiVersion:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ev1\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ekind:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ePod\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emetadata:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epod-volume-1\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003espec:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003econtainers:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econtainer1\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003eimage:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ekubetm/init\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003evolumeMounts:\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# Volume mount\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eempty-dir\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003emountPath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/mount1\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# Container1 이 사용하는 path =\u003e /mount1\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econtainer2\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003eimage:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ekubetm/init\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003evolumeMounts:\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# Volume mount\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eempty-dir\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003emountPath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/mount2\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# Container2 가 사용하는 path =\u003e /mount2\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003evolumes:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eempty-dir\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003eemptyDir:\u003c/span\u003e { }          \u003cspan class=\"hljs-comment\"\u003e# Volume 의 속성으로 emptyDir 을 지정\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# mountPath : Container 가 이 Path 로 Volume 을 연결함을 의미\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# mountPath 의 경로가 다르지만 Path 가 지정되는 Volume 의 이름이\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#  empty-dir 로 동일하기 때문에 container 마다 자신이 원하는 경로를 사용하고 있지만\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#  결국 같은 Volume 을 mount 하고 있다.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003ehostPath\u003c/h1\u003e\n\u003cp\u003e이름에서 알 수 있듯 하나의 host 즉, Pod 들이 올라가 있는 Node 에 path 를 Volume 으로 사용한다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/tech-blog/resources/images/kubernetes/0007-03.png\" alt=\"0007-03\"\u003e\u003c/p\u003e\n\u003cp\u003eemptyDir 과 다른 점은 Path 를 각 Pod 들이 mount 해서 공유하기 때문에 Pod 가 삭제 되어도 Node 에 있는 데이터는 사라지지 않는다. 데이터가 사라지지 않아 좋아 보이지만 Pod 입장에서\n문제가 있다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/tech-blog/resources/images/kubernetes/0007-04.png\" alt=\"0007-04\"\u003e\u003c/p\u003e\n\u003cp\u003e만약 다양한 이유로 Pod 가 다시 생성될 때 다른 Node 에 만들어지는 경우 Pod 가 사용하던 Volume 은 hostPath 에 mount 되어있었기 때문에 Volume 을 사용할 수 없게 된다. 왜냐하면\nPod 는 자신이 올라간 Node 에 있는 Volume 만 사용할 수 있기 때문이다.\u003c/p\u003e\n\u003cp\u003ePod 가 다시 생성되는 경우 발생하는 문제를 해결한다고 하면, Node 가 생성될 때마다 같은 이름의 경로를 만들어서 직접 Node 에 있는 Path 끼리 mount 해주면 되긴 하지만 이 방법은 k8s 가 해주지\n않고 관리자가 직접 설정해줘야 한다. 이렇게 구성하는 것이 그렇게 어렵고 복잡한 것은 아니지만 실수할 여지가 있기 때문에 추천하는 방법은 아니다.\u003c/p\u003e\n\u003cp\u003e각 Node 는 기본적으로 시스템 파일 또는 다양한 설정 파일과 같이 자기 자신을 위해 사용되는 파일들이 있다. Pod 자신이 할당되어 있는 host 에 데이터를 읽거나 써야할 때 사용하면 된다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yml\"\u003e\u003cspan class=\"hljs-attr\"\u003eapiVersion:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ev1\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ekind:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ePod\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emetadata:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epod-volume-3\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003espec:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003enodeSelector:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ekubernetes.io/hostname:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ek8s-node1\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003econtainers:\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# Pod 를 만들 때 Conatiner 에서 \u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econtainer\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003eimage:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ekubetm/init\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003evolumeMounts:\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# Volume 을 mount 하는데\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehost-path\u003c/span\u003e         \u003cspan class=\"hljs-comment\"\u003e# host-path 라는 이름의 Volume 을 사용 하고\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003emountPath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/mount1\u003c/span\u003e      \u003cspan class=\"hljs-comment\"\u003e# Path 는 mount1 이다.\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003evolumes:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehost-path\u003c/span\u003e          \u003cspan class=\"hljs-comment\"\u003e# host-path 라는 이름의 Volume\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003ehostPath:\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# hostPath 라는 속성을 사용한다.\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003epath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/node-v\u003c/span\u003e           \u003cspan class=\"hljs-comment\"\u003e# Path 는 node-v 이고 \u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003etype:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eDirectory\u003c/span\u003e         \u003cspan class=\"hljs-comment\"\u003e# type 은 Directory 이다.\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 추가로 hostPaht 의 path: /node-v 는 이 Pod 가 만들어지기 전에 만들어져 있어야 한다.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ehostPath 는 Pod 의 데이터를 저장하기 위한 용도가 아니고 Node 에 있는 데이터를 Pod 에서 사용하기 위한 용도이다.\u003c/p\u003e\n\u003ch1\u003ePVC/PV (Persistent Volume Claim/ Persistent Volume)\u003c/h1\u003e\n\u003cp\u003ePVC/PV 는 Pod 에 영속성 있는 Volume 을 제공하기 위한 기능이다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/tech-blog/resources/images/kubernetes/0007-05.png\" alt=\"0007-05\"\u003e\u003c/p\u003e\n\u003cp\u003e실제 Volume 의 형태는 다양하다. Local Volume 도 있지만 외부에 원격으로 사용되는 형태의 aws, git 등과 같은 Volume 들도 있다.\u003c/p\u003e\n\u003cp\u003ePod 는 이런 PV 에 바로 연결하지 않고 PVC 를 통해 PV 와 연결 된다. k8s 는 Volume 사용에 있어서 User 영역과 Admin 영역으로 나누었다. Admin 은 k8s 를 관리하는 운영자이고\nUser 는 Pod 에 Service 를 만들고 배포를 관리하는 서비스 담당자 이다.\u003c/p\u003e\n\u003cp\u003e앞서 Volume 의 종류가 다양하기 때문에 각 Volume 에 연결하기 위한 방법과 설정이 상이하다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yml\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 각 Volume 에 따라 서로 다른 설정 값이 사용 되는 예시 (nfs, iscsi, gitrepo)\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eapiVersion:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ev1\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ekind:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ePersistentVolume\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emetadata:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epv-01\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003espec:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003enfs:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eserver:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e.xxx\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003epath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/sda/data\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eiscsi:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003etargetPortal:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e163.180\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eiqn:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eiqn.200.qnap:...\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003elun:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003efsType:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eext4\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ereadOnly:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eno\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003echapAuthSession:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003egitRepo:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003erepository:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egithub.com...\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003erevision:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emaster\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003edirectory:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그렇기 때문에 이런 설정들을 전문적으로 관리하는 PV 들을 만들어 사용하고 User 는 이것을 사용 하기 위해 PVC 를 만들게 된다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yml\"\u003e\u003cspan class=\"hljs-comment\"\u003e# PV 를 사용하기 위한 User 의 PVC 설정 예시\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eapiVersion:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ev1\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ekind:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ePersistentVolumeClaim\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emetadata:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epvc-01\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003espec:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eaccessModes:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eReadWriteOnce\u003c/span\u003e          \u003cspan class=\"hljs-comment\"\u003e# 읽기 쓰기 모드가 가능한\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eresources:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003erequests:\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003estorage:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e1G\u003c/span\u003e          \u003cspan class=\"hljs-comment\"\u003e# 용량 1 기가인 Volume 을 요청\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003estorageClassName:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e     \u003cspan class=\"hljs-comment\"\u003e# 공백으로 넣으면 현재 만들어진 PV 중 선택 된다\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# 이 값을 \"\" 대신 생략하게 되면 다른 동작을 할 수 있다.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yml\"\u003e\u003cspan class=\"hljs-comment\"\u003e# PVC 를 사용하는 Pod 설정 예시\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eapiVersion:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ev1\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ekind:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ePod\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emetadata:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epod-volume-3\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003espec:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003econtainers:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econtainer\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003eimage:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ekubetm/init\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003evolumeMounts:\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epvc-pv\u003c/span\u003e         \u003cspan class=\"hljs-comment\"\u003e# 만든어진 PVC 를 Container 에서 사용\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003emountPath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/mount3\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003evolumes:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epvc-pv\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003epersistentVolumeClaim:\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eclaimName:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epvc-01\u003c/span\u003e     \u003cspan class=\"hljs-comment\"\u003e# 앞서 만든 PVC 이름을 연결\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e처리 흐름을 정리하면 다음과 같다.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e최초 Admin 이 PV 를 만들어 둔다.\u003c/li\u003e\n\u003cli\u003e사용자 (User) 가 PVC 를 만든다.\u003c/li\u003e\n\u003cli\u003ek8s 가 PVC 내용에 맞는 적정한 Volume 에 연결 해준다.\u003c/li\u003e\n\u003cli\u003e이후 Pod 생성시 PVC 를 사용한다.\u003c/li\u003e\n\u003c/ol\u003e"])</script><script>self.__next_f.push([1,"6:[[\"$\",\"div\",null,{\"className\":\"$undefined\",\"children\":[[\"$\",\"header\",null,{\"className\":\"PostHeader_postHeader__OohTH\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"PostHeader_title__NoKGt\",\"children\":\"Volume (emptyDir, hostPath, PVC/PV)\"}],[\"$\",\"p\",null,{\"className\":\"PostHeader_description__moC_r\",\"children\":\"\"}],[\"$\",\"div\",null,{\"className\":\"PostHeader_meta__9Swgx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"$undefined\",\"children\":\"nimkoes\"}],[\"$\",\"span\",null,{\"className\":\"$undefined\",\"children\":\"2021-03-02\"}]]}],[\"$\",\"div\",null,{\"className\":\"PostHeader_tags__lGQ1Q\",\"children\":[[\"$\",\"span\",\"Kubernetes\",{\"className\":\"PostHeader_tag__Jf7BC\",\"children\":\"Kubernetes\"}],[\"$\",\"span\",\"k8s\",{\"className\":\"PostHeader_tag__Jf7BC\",\"children\":\"k8s\"}],[\"$\",\"span\",\"infra\",{\"className\":\"PostHeader_tag__Jf7BC\",\"children\":\"infra\"}]]}]]}],[\"$\",\"$Le\",null,{}],[\"$\",\"article\",null,{\"className\":\"page_markdown__SVl4d\",\"children\":[[\"$\",\"$Lf\",null,{\"className\":\"page_topAd__ctbB7\"}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\"}}],[\"$\",\"$L10\",null,{\"className\":\"page_middleAd__4qBOv\",\"client\":\"ca-pub-6151583773425822\",\"slot\":\"your-ad-slot-id\"}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$11\"}}],[\"$\",\"$L10\",null,{\"className\":\"page_bottomAd__f0OO_\",\"client\":\"ca-pub-6151583773425822\",\"slot\":\"your-ad-slot-id\"}]]}]]}],[\"$\",\"div\",null,{\"className\":\"page_floatingButtons__qJiZU\",\"children\":[\"$\",\"$L12\",null,{}]}],[\"$\",\"$L13\",null,{}]]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Volume (emptyDir, hostPath, PVC/PV) | Nimkoes Tech Blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"기본 설명\"}],[\"$\",\"meta\",\"4\",{\"name\":\"application-name\",\"content\":\"Nimkoes Tech Blog\"}],[\"$\",\"link\",\"5\",{\"rel\":\"author\",\"href\":\"https://nimkoes.github.io/tech-blog\"}],[\"$\",\"meta\",\"6\",{\"name\":\"author\",\"content\":\"Nimkoes\"}],[\"$\",\"link\",\"7\",{\"rel\":\"manifest\",\"href\":\"/tech-blog/site.webmanifest\",\"crossOrigin\":\"use-credentials\"}],[\"$\",\"meta\",\"8\",{\"name\":\"keywords\",\"content\":\"tech-blog,backend,software architect,infrastructure,development\"}],[\"$\",\"meta\",\"9\",{\"name\":\"creator\",\"content\":\"Nimkoes\"}],[\"$\",\"meta\",\"10\",{\"name\":\"publisher\",\"content\":\"Nimkoes\"}],[\"$\",\"meta\",\"11\",{\"name\":\"robots\",\"content\":\"index, follow, nocache\"}],[\"$\",\"meta\",\"12\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"meta\",\"13\",{\"name\":\"category\",\"content\":\"technology\"}],[\"$\",\"link\",\"14\",{\"rel\":\"canonical\",\"href\":\"https://nimkoes.github.io/tech-blog\"}],[\"$\",\"link\",\"15\",{\"rel\":\"alternate\",\"hrefLang\":\"ko-KR\",\"href\":\"https://nimkoes.github.io/tech-blog\"}],[\"$\",\"meta\",\"16\",{\"name\":\"format-detection\",\"content\":\"telephone=no, address=no, email=no\"}],[\"$\",\"meta\",\"17\",{\"name\":\"google-adsense-account\",\"content\":\"ca-pub-6151583773425822\"}],[\"$\",\"meta\",\"18\",{\"property\":\"og:title\",\"content\":\"Nimkoes Tech Blog - 개발자의 기술 이야기\"}],[\"$\",\"meta\",\"19\",{\"property\":\"og:description\",\"content\":\"I work diligently to become lazy ☕\"}],[\"$\",\"meta\",\"20\",{\"property\":\"og:url\",\"content\":\"https://nimkoes.github.io/tech-blog\"}],[\"$\",\"meta\",\"21\",{\"property\":\"og:site_name\",\"content\":\"Nimkoes Tech Blog\"}],[\"$\",\"meta\",\"22\",{\"property\":\"og:locale\",\"content\":\"ko_KR\"}],[\"$\",\"meta\",\"23\",{\"property\":\"og:image\",\"content\":\"https://nimkoes.github.io/tech-blog/og-image.png\"}],[\"$\",\"meta\",\"24\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"25\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"26\",{\"property\":\"og:image:alt\",\"content\":\"Nimkoes Tech Blog\"}],[\"$\",\"meta\",\"27\",{\"property\":\"og:image:type\",\"content\":\"image/png\"}],[\"$\",\"meta\",\"28\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"29\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"30\",{\"name\":\"twitter:site\",\"content\":\"@nimkoes\"}],[\"$\",\"meta\",\"31\",{\"name\":\"twitter:creator\",\"content\":\"@nimkoes\"}],[\"$\",\"meta\",\"32\",{\"name\":\"twitter:title\",\"content\":\"Nimkoes Tech Blog\"}],[\"$\",\"meta\",\"33\",{\"name\":\"twitter:description\",\"content\":\"I work diligently to become lazy ☕\"}],[\"$\",\"meta\",\"34\",{\"name\":\"twitter:image\",\"content\":\"https://nimkoes.github.io/tech-blog/og-image.png\"}],[\"$\",\"link\",\"35\",{\"rel\":\"icon\",\"href\":\"/tech-blog/favicon.ico\",\"sizes\":\"any\"}],[\"$\",\"link\",\"36\",{\"rel\":\"icon\",\"href\":\"/tech-blog/icon.svg\",\"type\":\"image/svg+xml\"}],[\"$\",\"link\",\"37\",{\"rel\":\"icon\",\"href\":\"/tech-blog/favicon-32x32.png\",\"sizes\":\"32x32\",\"type\":\"image/png\"}],[\"$\",\"link\",\"38\",{\"rel\":\"icon\",\"href\":\"/tech-blog/favicon-16x16.png\",\"sizes\":\"16x16\",\"type\":\"image/png\"}],[\"$\",\"link\",\"39\",{\"rel\":\"apple-touch-icon\",\"href\":\"/tech-blog/apple-touch-icon.png\",\"sizes\":\"180x180\",\"type\":\"image/png\"}],[\"$\",\"link\",\"40\",{\"rel\":\"mask-icon\",\"href\":\"/tech-blog/safari-pinned-tab.svg\",\"color\":\"#5bbad5\"}],[\"$\",\"meta\",\"41\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"5:null\n"])</script></body></html>